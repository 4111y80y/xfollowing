# X互关宝 (xfollowing)

X互关宝是一个帮助用户在X.com (Twitter)上获取互关粉丝的开源工具。

## 功能特点

### 智能帖子监控
- **自动切换关键词**: 每30-60秒自动切换到下一个关键词的搜索页面，覆盖更多互关用户
- **只采集蓝V用户**: 自动过滤非认证用户，搜索添加 `filter:blue_verified`
- **@提及采集**: 自动采集帖子中@提及的用户，因为这些用户也有互关需求
- **智能去重与激活**: 重复出现的用户会自动前置，优先关注活跃用户
- 支持自定义关键词，双击关键词可跳转到该关键词的Latest搜索
- 定时扫描页面（每5秒），自动采集新出现的帖子
- 帖子按采集时间降序排序，最新发现的排在最前

### 智能自动关注
- **自动批量关注**: 一键启动，自动从上往下依次关注所有未关注用户
- **智能跳过**: 自动检测并跳过已关注用户、自己的页面、已关注我的用户
- **账号检测**: 自动检测账号被封禁/不存在/临时限制等情况，自动跳过并删除记录
- **Follow back 支持**: 兼容 "Follow back" 按钮，对方已关注你时自动回关
- **连续失败保护**: 连续失败3次自动进入30分钟休眠，避免触发风控
- 关注前等待页面完全加载（2秒），确保点击有效
- 关注后自动验证是否成功，失败自动重试（最多2次）

### 回关检查与管理
- **自动检查回关**: 关注指定天数（默认2天）后，自动检查用户是否回关
- **自动取消关注**: 未回关的用户自动取消关注，释放关注名额
- **可配置天数**: "未回关取关天数"设置，1-30天可选
- 冷却期间自动执行回关检查，高效利用等待时间
- 7天内检查过的用户不重复检查

### 冷却保护
- 关注后随机冷却60-180秒（可自定义范围，最小60秒）
- 冷却期间禁止手动/自动关注，防止频繁操作被封号
- 右侧浏览器顶部显示醒目倒计时（含颜色状态提示）
- 自动关注模式下，冷却结束自动继续下一个

### 日志与状态管理
- **实时日志显示**: 右侧底部终端风格日志框，显示所有重要操作
- **自动限制日志**: 最多保留100行日志，避免内存占用
- 标记已关注的帖子，支持隐藏已关注（默认开启）
- 已关注作者列表，双击可查看其主页
- 所有设置自动保存，下次启动恢复
- 默认关键词"互关"不可删除

### 粉丝采集浏览器
- **双浏览器布局**: 左侧上下分割，上方搜索浏览器，下方粉丝浏览器
- **自动浏览粉丝列表**: 自动访问已关注用户的 `verified_followers` 页面
- **采集未关注的蓝V**: 只采集没有关注你的蓝V用户（跳过有"Follows you"标签的）
- **自动切换用户**: 每30-60秒随机切换到下一个互关用户的粉丝页面
- 采集的用户自动添加到监控列表，可进行后续关注

### 界面布局
- 三栏布局: 左侧浏览器区（上下分割）、中间控制面板、右侧用户页
- 左侧上方: 搜索浏览器（关键词搜索）
- 左侧下方: 粉丝浏览器（互关用户的粉丝列表）
- 右侧浏览器延迟初始化，点击帖子时才创建
- 作者链接: 底部提供X主页和GitHub仓库链接

## 截图预览

```
+------------------------------------------------------------------+
|                         X互关宝                                   |
+------------------------------------------------------------------+
|  +----------------+  +------------------+  +------------------+   |
|  |   搜索浏览器    |  |   [关键词设置]    |  |                  |   |
|  |   (关键词搜索)  |  |  +-----------+   |  |   右侧浏览器      |   |
|  |                |  |  | 互关      |   |  |   (用户页面)      |   |
|  +----------------+  |  +-----------+   |  |                  |   |
|  |   粉丝浏览器    |  |   [帖子列表]     |  |  [冷却倒计时]     |   |
|  |   (蓝V粉丝)    |  |  +-----------+   |  |                  |   |
|  |                |  |  | @user1 [v]|   |  |                  |   |
|  |                |  |  | @user2    |   |  |                  |   |
|  |                |  |  +-----------+   |  |  [日志面板]       |   |
|  |                |  |  [x] 隐藏已关注  |  |                  |   |
|  |                |  |  冷却: 60~180秒  |  |                  |   |
|  |                |  |  [自动关注] X|GH |  |                  |   |
|  +----------------+  +------------------+  +------------------+   |
+------------------------------------------------------------------+
|  已采集: 123 | 已关注: 45 | 待关注: 78                            |
+------------------------------------------------------------------+
```

## 技术栈

- C++ 17
- Qt 6.10.1
- CEF (Chromium Embedded Framework)
- CMake

## 系统要求

- Windows 10/11 64位
- 其他系统暂不支持（CEF依赖平台特定版本）

## 下载使用

### 方式一：下载Release版本
1. 从 [Releases](https://github.com/4111y80y/xfollowing/releases) 下载最新版本
2. 解压到任意目录
3. 运行 `xfollowing.exe`
4. 首次使用需要在左侧浏览器登录X.com账号

### 方式二：自行编译
参见下方编译步骤。

## 编译要求

- Windows 10/11
- Visual Studio 2022 (MSVC)
- Qt 6.10.1 MSVC 2022 64bit
- CEF库

## 编译步骤

1. 确保Qt和CEF路径正确配置在CMakeLists.txt中
2. 使用Qt Creator打开CMakeLists.txt
3. 选择MSVC 2022 64bit编译套件
4. 构建项目

```bash
mkdir build
cd build
cmake -G "Ninja" -DCMAKE_BUILD_TYPE=Release ..
cmake --build .
```

## 使用方法

### 基本使用
1. 启动程序后，左侧浏览器会打开X.com搜索页
2. 登录你的X.com账号（登录状态会保存）
3. 在中间面板设置监控关键词（默认"互关"）
4. 程序会自动监控匹配的蓝V用户帖子并显示在列表中
5. 点击帖子，右侧浏览器会打开该用户的主页并自动关注
6. 已关注的帖子会标记[v]

### 自动批量关注
1. 等待采集到足够的帖子
2. 点击"自动关注"按钮（蓝色）
3. 程序会自动从上往下依次关注所有未关注用户
4. 每次关注后随机冷却60-180秒
5. 遇到已关注或自己的页面会自动跳过（无需冷却）
6. 点击"停止关注"（红色）可随时停止

### 快捷操作
- 双击关键词: 跳转到该关键词的Latest搜索页面
- 点击已关注列表中的作者: 查看其主页（不会触发关注）

## 数据存储

所有数据保存在程序目录下：

```
xfollowing/
├── xfollowing.exe
├── data/
│   ├── posts.json      # 帖子记录
│   └── keywords.json   # 关键词配置
├── userdata/
│   └── default/        # 浏览器登录状态
└── logs/               # 调试日志
```

## 项目结构

```
xfollowing/
├── CMakeLists.txt
├── README.md
├── src/
│   ├── main.cpp
│   ├── App/           # CEF集成
│   │   ├── CefApp.h/cpp
│   │   └── CefHandler.h/cpp
│   ├── UI/            # 用户界面
│   │   ├── MainWindow.h/cpp
│   │   ├── BrowserWidget.h/cpp
│   │   ├── KeywordPanel.h/cpp
│   │   └── PostListPanel.h/cpp
│   ├── Data/          # 数据结构和存储
│   │   ├── Post.h
│   │   ├── Keyword.h
│   │   └── DataStorage.h/cpp
│   └── Core/          # 核心功能
│       ├── PostMonitor.h/cpp
│       └── AutoFollower.h/cpp
```

## 注意事项

- 首次使用需要在左侧浏览器登录X.com账号
- 登录状态会保存在userdata目录，下次启动无需重新登录
- 建议冷却时间不要设置太短（最小60秒），避免被X.com限制
- 本工具仅供学习交流使用，请遵守X.com使用条款

## 更新日志

### v1.0.3 (2025-01-28)

**新功能**
- [NEW] 粉丝采集浏览器：左侧新增第二个浏览器，自动浏览互关用户的蓝V粉丝列表
- [NEW] 双浏览器布局：左侧上下1:1分割，上方搜索浏览器，下方粉丝浏览器
- [NEW] 自动切换粉丝页：每30-60秒随机切换到下一个互关用户的 verified_followers 页面
- [NEW] 智能过滤采集：只采集蓝V用户，自动跳过已关注你的用户（无"Follows you"标签）
- [NEW] 数据安全保护：数据文件移至独立目录，防止误删

**改进**
- [FIX] 修复数据恢复：新增 collect_following.js 脚本支持从X.com采集关注数据
- [FIX] 优化延迟初始化：粉丝浏览器在搜索浏览器加载后3秒才创建，避免CEF冲突

### v1.0.2 (2025-01-26)

**新功能**
- ✨ 自动切换关键词搜索：每30-60秒切换到下一个关键词页面，覆盖更多互关用户
- ✨ @提及用户采集：自动采集帖子中@的用户，扩大互关来源
- ✨ 智能去重与激活：重复出现的用户自动前置，优先关注活跃用户
- ✨ 回关检查功能：可配置天数（默认2天），自动检查并取消未回关用户
- ✨ 实时日志显示：右侧底部终端风格日志框，记录所有重要操作
- ✨ 连续失败保护：连续失败3次自动休眠30分钟，避免触发风控

**改进**
- 🎯 只采集蓝V用户：搜索自动添加 `filter:blue_verified` 过滤
- 🎯 Follow back 支持：兼容"Follow back"按钮，对方已关注你时自动回关
- 🎯 账号状态检测：自动检测账号被封禁/不存在/临时限制等情况
- 🎯 帖子排序优化：按采集时间降序，最新发现的在最前
- 🎯 DPI 缩放修复：修复高DPI（125%+）显示问题
- 🎯 消除 CEF 警告：禁用 GCM 服务，消除控制台警告信息

**技术优化**
- 📝 使用相对路径，支持便携式部署
- 📝 日志自动限制100行，避免内存占用
- 📝 Windows UTF-8 编码支持优化

### v1.0.0 (2025-01-19)
- 首次发布
- 支持帖子监控和自动关注
- 支持自动批量关注
- 只采集蓝V用户
- 随机冷却时间保护
- 自动跳过已关注和自己的页面

## 开源协议

MIT License

## 作者

- X: [@4111y80y](https://x.com/4111y80y)
- GitHub: [4111y80y/xfollowing](https://github.com/4111y80y/xfollowing)

## 支持项目

如果这个工具对你有帮助，欢迎：
- 在GitHub上点个Star
- 在X上关注作者 [@4111y80y](https://x.com/4111y80y)
- 分享给需要的朋友
